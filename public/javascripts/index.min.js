var canvas,c,timer,gtime=new Date,gtime_last,is_static=0,incr=0,image=new Image,background_is_load=0;function draw(){image.onload=function(){background_is_load=1;doScene()};image.src=c.image}function wrapText(a,b,e,f,d,h){var b=b.split(" "),i="",g,k,j;for(g=0;g<b.length;g+=1)k=i+b[g]+" ",j=a.measureText(k),j=j.width,j>d?(a.fillText(i,e,f),i=b[g]+" ",f+=h):i=k;a.fillText(i,e,f)}
function doScene(){var a=canvas.getContext("2d"),b;a.clearRect(0,0,canvas.width,canvas.height);1===background_is_load&&a.drawImage(image,0,0,canvas.width,canvas.height);a.lineWidth=5;a.font="50pt Tangerine";a.fillStyle="white";a.fillText(document.title,0.05*canvas.width,0.3*canvas.height);a.font="20pt Tangerine";a.fillText("spirina.yulia.a@gmail.com",0.05*canvas.width,0.7*canvas.height);a.fillText("spirin.vladimir@gmail.com",0.05*canvas.width,0.8*canvas.height);for(b in c.b)a.beginPath(),1===is_static?
a.arc(c.b[b].x,c.b[b].y,c.b[b].r,0,2*Math.PI,!1):a.arc(c.b[b].x_din,c.b[b].y_din,c.b[b].r,0,2*Math.PI,!1),a.fillStyle=c.b[b].color,a.fill(),a.closePath(),a.font=2*c.lineHeight+"pt Tangerine",a.fillStyle="white",1===is_static?wrapText(a,c.b[b].text,c.b[b].x-c.b[b].r/2,c.b[b].y,c.maxWidth,c.lineHeight):wrapText(a,c.b[b].text,c.b[b].x_din-c.b[b].r/2,c.b[b].y_din,c.maxWidth,c.lineHeight)}
function getCursorPosition(a){var b;a.pageX||a.pageY?(b=a.pageX,a=a.pageY):(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);b-=canvas.offsetLeft;a-=canvas.offsetTop;return{x:b,y:a}}function near(a,b,e,f,d){return Math.pow(a-e,2)+Math.pow(b-f,2)<=Math.pow(d,2)?1:0}
function md(a){if(0!==is_static){var a=getCursorPosition(a),b;c.m_down=a;for(b in c.b)near(a.x,a.y,c.b[b].x,c.b[b].y,c.b[b].r)&&(c.b[b].move=1);for(b in c.b)if(1===c.b[b].move){timer=new Date;break}}}function mu(){if(0!==is_static){var a=0,b;for(b in c.b)1===c.b[b].move&&(a+=1);if(1<a)for(b in c.b)1===c.b[b].move&&(c.b[b].move=0);else for(b in c.b)1===c.b[b].move&&(a=new Date,300>a-timer&&(window.location.href+=c.b[b].text.toLowerCase()),c.b[b].move=0)}}
function mm(a){var b,e;if(0!==is_static){var a=getCursorPosition(a),f=0,d,h;for(d in c.b)near(a.x,a.y,c.b[d].x,c.b[d].y,c.b[d].r)?(0===c.b[d].re_draw&&(f=1,c.b[d].color=c.b[d].color.replace("0.6","0.9")),c.b[d].re_draw=1):(1===c.b[d].re_draw&&(f=1,c.b[d].color=c.b[d].color.replace("0.9","0.6")),c.b[d].re_draw=0);b=new Date;"undefined"===c.dtm&&(c.dtm=gtime);c.dtm=b-c.dtm;if(!(0>=parseInt(c.dtm))){b=a.x-c.m_down.x;e=a.y-c.m_down.y;h=0;for(d in c.b)1===c.b[d].move&&(c.b[d].x+=b,c.b[d].y+=e,c.b[d].x+
c.b[d].r>canvas.width?(near(a.x,a.y,c.b[d].x,c.b[d].y,c.b[d].r)||(c.b[d].move=0),c.b[d].x=canvas.width-c.b[d].r):c.b[d].y+c.b[d].r>canvas.height?(near(a.x,a.y,c.b[d].x,c.b[d].y,c.b[d].r)||(c.b[d].move=0),c.b[d].y=canvas.height-c.b[d].r):0>c.b[d].x-c.b[d].r?(near(a.x,a.y,c.b[d].x,c.b[d].y,c.b[d].r)||(c.b[d].move=0),c.b[d].x=c.b[d].r):0>c.b[d].y-c.b[d].r&&(near(a.x,a.y,c.b[d].x,c.b[d].y,c.b[d].r)||(c.b[d].move=0),c.b[d].y=c.b[d].r),1===is_static&&(h=1));c.m_down=a;c.dtm=new Date;(1===h||1===f)&&doScene()}}}
function mou(){if(0!==is_static)for(var a in c.b)c.b[a].move=0}
function calculate_displacement(){incr=is_static=1;var a,b;for(a in c.b)if(c.b[a].y_din<c.b[a].y&&(b=Math.floor((c.b[a].y-c.b[a].y_din)/10),0===b&&(b=1),c.b[a].y_din+=b,is_static=0),c.b[a].y_din>c.b[a].y&&(b=Math.floor((c.b[a].y_din-c.b[a].y)/10),0===b&&(b=1),c.b[a].y_din-=b,is_static=0),c.b[a].x_din<c.b[a].x&&(b=Math.floor((c.b[a].x-c.b[a].x_din)/10),0===b&&(b=1),c.b[a].x_din+=b,is_static=0),c.b[a].x_din>c.b[a].x)b=Math.floor((c.b[a].x_din-c.b[a].x)/10),0===b&&(b=1),c.b[a].x_din-=b,is_static=0}
window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();
function init(a){canvas=document.getElementsByTagName("canvas")[0];canvas.width=0.965*$(document).width();canvas.height=0.965*$(document).height();var b={width:canvas.width,height:canvas.height},e;$.ajax({type:"POST",url:a,data:b,async:!1,dataType:"json"}).done(function(a){c=jQuery.parseJSON(a)});draw(c.image,b);canvas.addEventListener("mousemove",mm,!1);canvas.addEventListener("mouseup",mu,!1);canvas.addEventListener("mousedown",md,!1);canvas.addEventListener("mouseout",mou,!1);for(e in c.b)c.b[e].x_din=
c.b[e].r,c.b[e].x_din=0.1>Math.sin(Math.PI*c.b[e].r*c.b[e].x/canvas.width)?c.b[e].r:c.b[e].x+c.b[e].r,c.b[e].y_din=0.9<Math.sin(Math.PI*c.b[e].r*c.b[e].y/canvas.height)?c.b[e].r:c.b[e].y+c.b[e].r;(function d(){1!==is_static&&(requestAnimFrame(d),gtime=new Date,gtime-=gtime_last,calculate_displacement(),doScene(),gtime_last=gtime)})()};
